import{c as le,Q as me,r as M,j as a,U as fe,m as he,a2 as U,B as L,aM as xe,E as ge,C as T,e as Y,a3 as we,b as Q,d as X,aN as ye,n as $,o as V,p as z,q as J,s as D,I as je,_ as be,F as Ne,G as ve,H as I,J as _,K as Oe,M as C,Y as De,t as B,x as ke,aO as Se}from"./index-1760363752138.js";import{A as Me,a as Te}from"./alert-1760363752138.js";import{t as y,c as S,g as G,n as Ye,a as K,m as Ce,b as ae,e as Ee,A as Z,G as Pe,f as A}from"./fr-1760363752138.js";const _e=le("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);function qe(r,e,t){const n=y(r,t==null?void 0:t.in);return isNaN(e)?S((t==null?void 0:t.in)||r,NaN):(e&&n.setDate(n.getDate()+e),n)}function W(r,e){var h,f,w,g;const t=G(),n=(e==null?void 0:e.weekStartsOn)??((f=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:f.weekStartsOn)??t.weekStartsOn??((g=(w=t.locale)==null?void 0:w.options)==null?void 0:g.weekStartsOn)??0,s=y(r,e==null?void 0:e.in),i=s.getDay(),u=(i<n?7:0)+i-n;return s.setDate(s.getDate()-u),s.setHours(0,0,0,0),s}function F(r,e){return W(r,{...e,weekStartsOn:1})}function se(r,e){const t=y(r,e==null?void 0:e.in),n=t.getFullYear(),s=S(t,0);s.setFullYear(n+1,0,4),s.setHours(0,0,0,0);const i=F(s),u=S(t,0);u.setFullYear(n,0,4),u.setHours(0,0,0,0);const h=F(u);return t.getTime()>=i.getTime()?n+1:t.getTime()>=h.getTime()?n:n-1}function p(r,e){const t=y(r,e==null?void 0:e.in);return t.setHours(0,0,0,0),t}function We(r,e,t){const[n,s]=Ye(t==null?void 0:t.in,r,e),i=p(n),u=p(s),h=+i-K(i),f=+u-K(u);return Math.round((h-f)/Ce)}function He(r,e){const t=se(r,e),n=S((e==null?void 0:e.in)||r,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),F(n)}function Ae(r){return r instanceof Date||typeof r=="object"&&Object.prototype.toString.call(r)==="[object Date]"}function Fe(r){return!(!Ae(r)&&typeof r!="number"||isNaN(+y(r)))}function Ge(r,e){const t=y(r,e==null?void 0:e.in);return t.setFullYear(t.getFullYear(),0,1),t.setHours(0,0,0,0),t}function Ie(r,e){const t=y(r,e==null?void 0:e.in);return We(t,Ge(t))+1}function Be(r,e){const t=y(r,e==null?void 0:e.in),n=+F(t)-+He(t);return Math.round(n/ae)+1}function ce(r,e){var g,j,N,v;const t=y(r,e==null?void 0:e.in),n=t.getFullYear(),s=G(),i=(e==null?void 0:e.firstWeekContainsDate)??((j=(g=e==null?void 0:e.locale)==null?void 0:g.options)==null?void 0:j.firstWeekContainsDate)??s.firstWeekContainsDate??((v=(N=s.locale)==null?void 0:N.options)==null?void 0:v.firstWeekContainsDate)??1,u=S((e==null?void 0:e.in)||r,0);u.setFullYear(n+1,0,i),u.setHours(0,0,0,0);const h=W(u,e),f=S((e==null?void 0:e.in)||r,0);f.setFullYear(n,0,i),f.setHours(0,0,0,0);const w=W(f,e);return+t>=+h?n+1:+t>=+w?n:n-1}function Re(r,e){var h,f,w,g;const t=G(),n=(e==null?void 0:e.firstWeekContainsDate)??((f=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??t.firstWeekContainsDate??((g=(w=t.locale)==null?void 0:w.options)==null?void 0:g.firstWeekContainsDate)??1,s=ce(r,e),i=S((e==null?void 0:e.in)||r,0);return i.setFullYear(s,0,n),i.setHours(0,0,0,0),W(i,e)}function Ue(r,e){const t=y(r,e==null?void 0:e.in),n=+W(t,e)-+Re(t,e);return Math.round(n/ae)+1}function d(r,e){const t=r<0?"-":"",n=Math.abs(r).toString().padStart(e,"0");return t+n}const b={y(r,e){const t=r.getFullYear(),n=t>0?t:1-t;return d(e==="yy"?n%100:n,e.length)},M(r,e){const t=r.getMonth();return e==="M"?String(t+1):d(t+1,2)},d(r,e){return d(r.getDate(),e.length)},a(r,e){const t=r.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(r,e){return d(r.getHours()%12||12,e.length)},H(r,e){return d(r.getHours(),e.length)},m(r,e){return d(r.getMinutes(),e.length)},s(r,e){return d(r.getSeconds(),e.length)},S(r,e){const t=e.length,n=r.getMilliseconds(),s=Math.trunc(n*Math.pow(10,t-3));return d(s,e.length)}},E={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},ee={G:function(r,e,t){const n=r.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(n,{width:"abbreviated"});case"GGGGG":return t.era(n,{width:"narrow"});case"GGGG":default:return t.era(n,{width:"wide"})}},y:function(r,e,t){if(e==="yo"){const n=r.getFullYear(),s=n>0?n:1-n;return t.ordinalNumber(s,{unit:"year"})}return b.y(r,e)},Y:function(r,e,t,n){const s=ce(r,n),i=s>0?s:1-s;if(e==="YY"){const u=i%100;return d(u,2)}return e==="Yo"?t.ordinalNumber(i,{unit:"year"}):d(i,e.length)},R:function(r,e){const t=se(r);return d(t,e.length)},u:function(r,e){const t=r.getFullYear();return d(t,e.length)},Q:function(r,e,t){const n=Math.ceil((r.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return d(n,2);case"Qo":return t.ordinalNumber(n,{unit:"quarter"});case"QQQ":return t.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(n,{width:"wide",context:"formatting"})}},q:function(r,e,t){const n=Math.ceil((r.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return d(n,2);case"qo":return t.ordinalNumber(n,{unit:"quarter"});case"qqq":return t.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(n,{width:"wide",context:"standalone"})}},M:function(r,e,t){const n=r.getMonth();switch(e){case"M":case"MM":return b.M(r,e);case"Mo":return t.ordinalNumber(n+1,{unit:"month"});case"MMM":return t.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(n,{width:"wide",context:"formatting"})}},L:function(r,e,t){const n=r.getMonth();switch(e){case"L":return String(n+1);case"LL":return d(n+1,2);case"Lo":return t.ordinalNumber(n+1,{unit:"month"});case"LLL":return t.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(n,{width:"wide",context:"standalone"})}},w:function(r,e,t,n){const s=Ue(r,n);return e==="wo"?t.ordinalNumber(s,{unit:"week"}):d(s,e.length)},I:function(r,e,t){const n=Be(r);return e==="Io"?t.ordinalNumber(n,{unit:"week"}):d(n,e.length)},d:function(r,e,t){return e==="do"?t.ordinalNumber(r.getDate(),{unit:"date"}):b.d(r,e)},D:function(r,e,t){const n=Ie(r);return e==="Do"?t.ordinalNumber(n,{unit:"dayOfYear"}):d(n,e.length)},E:function(r,e,t){const n=r.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(n,{width:"short",context:"formatting"});case"EEEE":default:return t.day(n,{width:"wide",context:"formatting"})}},e:function(r,e,t,n){const s=r.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return d(i,2);case"eo":return t.ordinalNumber(i,{unit:"day"});case"eee":return t.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(s,{width:"short",context:"formatting"});case"eeee":default:return t.day(s,{width:"wide",context:"formatting"})}},c:function(r,e,t,n){const s=r.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return d(i,e.length);case"co":return t.ordinalNumber(i,{unit:"day"});case"ccc":return t.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(s,{width:"narrow",context:"standalone"});case"cccccc":return t.day(s,{width:"short",context:"standalone"});case"cccc":default:return t.day(s,{width:"wide",context:"standalone"})}},i:function(r,e,t){const n=r.getDay(),s=n===0?7:n;switch(e){case"i":return String(s);case"ii":return d(s,e.length);case"io":return t.ordinalNumber(s,{unit:"day"});case"iii":return t.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(n,{width:"short",context:"formatting"});case"iiii":default:return t.day(n,{width:"wide",context:"formatting"})}},a:function(r,e,t){const s=r.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(r,e,t){const n=r.getHours();let s;switch(n===12?s=E.noon:n===0?s=E.midnight:s=n/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(r,e,t){const n=r.getHours();let s;switch(n>=17?s=E.evening:n>=12?s=E.afternoon:n>=4?s=E.morning:s=E.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(r,e,t){if(e==="ho"){let n=r.getHours()%12;return n===0&&(n=12),t.ordinalNumber(n,{unit:"hour"})}return b.h(r,e)},H:function(r,e,t){return e==="Ho"?t.ordinalNumber(r.getHours(),{unit:"hour"}):b.H(r,e)},K:function(r,e,t){const n=r.getHours()%12;return e==="Ko"?t.ordinalNumber(n,{unit:"hour"}):d(n,e.length)},k:function(r,e,t){let n=r.getHours();return n===0&&(n=24),e==="ko"?t.ordinalNumber(n,{unit:"hour"}):d(n,e.length)},m:function(r,e,t){return e==="mo"?t.ordinalNumber(r.getMinutes(),{unit:"minute"}):b.m(r,e)},s:function(r,e,t){return e==="so"?t.ordinalNumber(r.getSeconds(),{unit:"second"}):b.s(r,e)},S:function(r,e){return b.S(r,e)},X:function(r,e,t){const n=r.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return re(n);case"XXXX":case"XX":return k(n);case"XXXXX":case"XXX":default:return k(n,":")}},x:function(r,e,t){const n=r.getTimezoneOffset();switch(e){case"x":return re(n);case"xxxx":case"xx":return k(n);case"xxxxx":case"xxx":default:return k(n,":")}},O:function(r,e,t){const n=r.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+te(n,":");case"OOOO":default:return"GMT"+k(n,":")}},z:function(r,e,t){const n=r.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+te(n,":");case"zzzz":default:return"GMT"+k(n,":")}},t:function(r,e,t){const n=Math.trunc(+r/1e3);return d(n,e.length)},T:function(r,e,t){return d(+r,e.length)}};function te(r,e=""){const t=r>0?"-":"+",n=Math.abs(r),s=Math.trunc(n/60),i=n%60;return i===0?t+String(s):t+String(s)+e+d(i,2)}function re(r,e){return r%60===0?(r>0?"-":"+")+d(Math.abs(r)/60,2):k(r,e)}function k(r,e=""){const t=r>0?"-":"+",n=Math.abs(r),s=d(Math.trunc(n/60),2),i=d(n%60,2);return t+s+e+i}const ne=(r,e)=>{switch(r){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},ie=(r,e)=>{switch(r){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},Le=(r,e)=>{const t=r.match(/(P+)(p+)?/)||[],n=t[1],s=t[2];if(!s)return ne(r,e);let i;switch(n){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",ne(n,e)).replace("{{time}}",ie(s,e))},Qe={p:ie,P:Le},Xe=/^D+$/,$e=/^Y+$/,Ve=["D","DD","YY","YYYY"];function ze(r){return Xe.test(r)}function Je(r){return $e.test(r)}function Ke(r,e,t){const n=Ze(r,e,t);if(console.warn(n),Ve.includes(r))throw new RangeError(n)}function Ze(r,e,t){const n=r[0]==="Y"?"years":"days of the month";return`Use \`${r.toLowerCase()}\` instead of \`${r}\` (in \`${e}\`) for formatting ${n} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const pe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,et=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,tt=/^'([^]*?)'?$/,rt=/''/g,nt=/[a-zA-Z]/;function q(r,e,t){var g,j,N,v,H,c,x,l;const n=G(),s=(t==null?void 0:t.locale)??n.locale??Ee,i=(t==null?void 0:t.firstWeekContainsDate)??((j=(g=t==null?void 0:t.locale)==null?void 0:g.options)==null?void 0:j.firstWeekContainsDate)??n.firstWeekContainsDate??((v=(N=n.locale)==null?void 0:N.options)==null?void 0:v.firstWeekContainsDate)??1,u=(t==null?void 0:t.weekStartsOn)??((c=(H=t==null?void 0:t.locale)==null?void 0:H.options)==null?void 0:c.weekStartsOn)??n.weekStartsOn??((l=(x=n.locale)==null?void 0:x.options)==null?void 0:l.weekStartsOn)??0,h=y(r,t==null?void 0:t.in);if(!Fe(h))throw new RangeError("Invalid time value");let f=e.match(et).map(o=>{const m=o[0];if(m==="p"||m==="P"){const P=Qe[m];return P(o,s.formatLong)}return o}).join("").match(pe).map(o=>{if(o==="''")return{isToken:!1,value:"'"};const m=o[0];if(m==="'")return{isToken:!1,value:at(o)};if(ee[m])return{isToken:!0,value:o};if(m.match(nt))throw new RangeError("Format string contains an unescaped latin alphabet character `"+m+"`");return{isToken:!1,value:o}});s.localize.preprocessor&&(f=s.localize.preprocessor(h,f));const w={firstWeekContainsDate:i,weekStartsOn:u,locale:s};return f.map(o=>{if(!o.isToken)return o.value;const m=o.value;(!(t!=null&&t.useAdditionalWeekYearTokens)&&Je(m)||!(t!=null&&t.useAdditionalDayOfYearTokens)&&ze(m))&&Ke(m,e,String(r));const P=ee[m[0]];return P(h,m,s.localize,w)}).join("")}function at(r){const e=r.match(tt);return e?e[1].replace(rt,"'"):r}function R(r,e,t){return qe(r,-e,t)}const ut=()=>{const{user:r,isAdmin:e}=me(),[t,n]=M.useState([]),[s,i]=M.useState(!0),[u,h]=M.useState({action:"all",dateRange:"7",search:""}),[f,w]=M.useState({totalConnections:0,uniqueUsers:0,todayConnections:0,activeUsers:0});M.useEffect(()=>{!e&&!s&&(window.location.href="/")},[e,s]);const g=async()=>{i(!0);try{let c=B.from("access_logs").select("*").eq("log_type","connection").order("created_at",{ascending:!1});if(u.action!=="all"&&(c=c.eq("action",u.action)),u.dateRange!=="all"){const o=parseInt(u.dateRange),m=R(new Date,o);c=c.gte("created_at",m.toISOString())}u.search&&(c=c.or(`user_name.ilike.%${u.search}%,user_email.ilike.%${u.search}%`));const{data:x,error:l}=await c.limit(500);if(l)throw l;n(x||[])}catch(c){console.error("Erreur lors du chargement des logs:",c)}finally{i(!1)}},j=async()=>{try{const{data:c,error:x}=await B.from("access_logs").select("user_id, created_at").eq("log_type","connection").eq("action","login").order("created_at",{ascending:!1}).limit(1e3);if(x)throw x;const l=new Date,o=new Date(l.getFullYear(),l.getMonth(),l.getDate()),m=R(l,1),P=(c==null?void 0:c.length)||0,ue=new Set(c==null?void 0:c.map(O=>O.user_id)).size,de=(c==null?void 0:c.filter(O=>new Date(O.created_at)>=o).length)||0,oe=new Set(c==null?void 0:c.filter(O=>new Date(O.created_at)>=m).map(O=>O.user_id)).size;w({totalConnections:P,uniqueUsers:ue,todayConnections:de,activeUsers:oe})}catch(c){console.error("Erreur lors du chargement des statistiques:",c),w({totalConnections:0,uniqueUsers:0,todayConnections:0,activeUsers:0})}};M.useEffect(()=>{if(e){const c=setTimeout(()=>{g(),j()},300);return()=>clearTimeout(c)}},[e,u]);const N=()=>{const c=[["Date","Heure","Utilisateur","Email","Action","IP","Navigateur"].join(","),...t.map(o=>{var m;return[q(new Date(o.created_at),"dd/MM/yyyy",{locale:A}),q(new Date(o.created_at),"HH:mm:ss",{locale:A}),o.user_name||"N/A",o.user_email||"N/A",o.action,o.ip_address||"N/A",((m=o.metadata)==null?void 0:m.browser)||"N/A"].join(",")})].join(`
`),x=new Blob([c],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a");l.href=URL.createObjectURL(x),l.download=`logs-connexion-${q(new Date,"yyyy-MM-dd")}.csv`,l.click()},v=async()=>{if(confirm("Voulez-vous vraiment supprimer les logs de plus de 30 jours ?"))try{const c=R(new Date,30),{error:x}=await B.from("access_logs").delete().eq("log_type","connection").lt("created_at",c.toISOString());if(x)throw x;alert("Anciens logs supprimés avec succès"),g(),j()}catch(c){console.error("Erreur lors de la suppression:",c),alert("Erreur lors de la suppression des logs")}},H=c=>{const l={login:{variant:"default",icon:Se,color:"text-green-600"},logout:{variant:"secondary",icon:_e,color:"text-orange-600"}}[c]||{variant:"outline",icon:Z,color:"text-gray-600"},o=l.icon;return a.jsxs(ke,{variant:l.variant,className:"flex items-center gap-1",children:[a.jsx(o,{className:`w-3 h-3 ${l.color}`}),c==="login"?"Connexion":"Déconnexion"]})};return e?a.jsxs("div",{className:"space-y-6",children:[a.jsxs(fe,{children:[a.jsx("title",{children:"Logs de Connexion - Administration"}),a.jsx("meta",{name:"description",content:"Suivi des connexions et déconnexions des membres"})]}),a.jsxs(he.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(U,{className:"w-8 h-8 text-primary"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Logs de Connexion"}),a.jsx("p",{className:"text-muted-foreground",children:"Suivi des connexions des membres"})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(L,{onClick:N,variant:"outline",size:"sm",children:[a.jsx(xe,{className:"w-4 h-4 mr-2"}),"Exporter"]}),a.jsxs(L,{onClick:v,variant:"outline",size:"sm",children:[a.jsx(ge,{className:"w-4 h-4 mr-2"}),"Nettoyer"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx(T,{children:a.jsxs(Y,{className:"flex items-center p-6",children:[a.jsx(Z,{className:"w-8 h-8 text-blue-600 mr-3"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Connexions"}),a.jsx("p",{className:"text-2xl font-bold",children:f.totalConnections})]})]})}),a.jsx(T,{children:a.jsxs(Y,{className:"flex items-center p-6",children:[a.jsx(U,{className:"w-8 h-8 text-green-600 mr-3"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Utilisateurs Uniques"}),a.jsx("p",{className:"text-2xl font-bold",children:f.uniqueUsers})]})]})}),a.jsx(T,{children:a.jsxs(Y,{className:"flex items-center p-6",children:[a.jsx(we,{className:"w-8 h-8 text-orange-600 mr-3"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Aujourd'hui"}),a.jsx("p",{className:"text-2xl font-bold",children:f.todayConnections})]})]})}),a.jsx(T,{children:a.jsxs(Y,{className:"flex items-center p-6",children:[a.jsx(Pe,{className:"w-8 h-8 text-purple-600 mr-3"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Actifs (24h)"}),a.jsx("p",{className:"text-2xl font-bold",children:f.activeUsers})]})]})})]}),a.jsxs(T,{children:[a.jsx(Q,{children:a.jsxs(X,{className:"flex items-center gap-2",children:[a.jsx(ye,{className:"w-5 h-5"}),"Filtres"]})}),a.jsx(Y,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Action"}),a.jsxs($,{value:u.action,onValueChange:c=>h({...u,action:c}),children:[a.jsx(V,{children:a.jsx(z,{})}),a.jsxs(J,{children:[a.jsx(D,{value:"all",children:"Toutes les actions"}),a.jsx(D,{value:"login",children:"Connexions"}),a.jsx(D,{value:"logout",children:"Déconnexions"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Période"}),a.jsxs($,{value:u.dateRange,onValueChange:c=>h({...u,dateRange:c}),children:[a.jsx(V,{children:a.jsx(z,{})}),a.jsxs(J,{children:[a.jsx(D,{value:"1",children:"Aujourd'hui"}),a.jsx(D,{value:"7",children:"7 derniers jours"}),a.jsx(D,{value:"30",children:"30 derniers jours"}),a.jsx(D,{value:"all",children:"Toutes les dates"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Recherche"}),a.jsx(je,{placeholder:"Nom ou email...",value:u.search,onChange:c=>h({...u,search:c.target.value})})]})]})})]}),a.jsxs(T,{children:[a.jsx(Q,{children:a.jsxs(X,{className:"flex items-center gap-2",children:[a.jsx(be,{className:"w-5 h-5"}),"Logs de Connexion (",t.length,")"]})}),a.jsx(Y,{children:s?a.jsx("div",{className:"flex justify-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):a.jsx("div",{className:"rounded-md border",children:a.jsxs(Ne,{children:[a.jsx(ve,{children:a.jsxs(I,{children:[a.jsx(_,{children:"Date & Heure"}),a.jsx(_,{children:"Utilisateur"}),a.jsx(_,{children:"Action"}),a.jsx(_,{children:"IP"}),a.jsx(_,{children:"Navigateur"})]})}),a.jsx(Oe,{children:t.length===0?a.jsx(I,{children:a.jsx(C,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"Aucun log trouvé"})}):t.map(c=>{var x,l;return a.jsxs(I,{children:[a.jsx(C,{children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(De,{className:"w-4 h-4 text-muted-foreground"}),a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:q(new Date(c.created_at),"dd/MM/yyyy",{locale:A})}),a.jsx("div",{className:"text-sm text-muted-foreground",children:q(new Date(c.created_at),"HH:mm:ss",{locale:A})})]})]})}),a.jsx(C,{children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:c.user_name||"N/A"}),a.jsx("div",{className:"text-sm text-muted-foreground",children:c.user_email})]})}),a.jsx(C,{children:H(c.action)}),a.jsx(C,{children:a.jsx("code",{className:"text-sm",children:c.ip_address||"N/A"})}),a.jsx(C,{children:a.jsxs("div",{className:"text-sm",children:[((x=c.metadata)==null?void 0:x.browser)||"N/A",((l=c.metadata)==null?void 0:l.platform)&&a.jsx("div",{className:"text-xs text-muted-foreground",children:c.metadata.platform})]})})]},c.id)})})]})})})]})]}):a.jsx(Me,{children:a.jsx(Te,{children:"Accès non autorisé. Cette page est réservée aux administrateurs."})})};export{ut as default};
