import{r as d,l as _,j as e,m as y,F as v,y as E}from"./index-1760860133980.js";const C=()=>{const[p,b]=d.useState({}),[f,m]=d.useState(!0),[n,j]=d.useState(null),g=_();if(d.useEffect(()=>{(async()=>{m(!0);try{const{data:t,error:a}=await E.from("member_schedule").select("id, member:members(id, first_name, last_name), schedule:schedules(id, type, age_category, day,start_time, end_time)").order("schedule_id",{ascending:!0});if(a)throw a;const N=(t||[]).reduce((l,r)=>{var o,h,x;const i=r.schedule||{},c=i.id||r.schedule_id||"unknown";return l[c]||(l[c]={schedule:i,members:[]}),l[c].members.push({id:r.id,memberId:((o=r.member)==null?void 0:o.id)||r.member_id,first_name:((h=r.member)==null?void 0:h.first_name)||"",last_name:((x=r.member)==null?void 0:x.last_name)||""}),l},{});b(N)}catch(t){console.error("Erreur fetching member_schedule:",t),j(t.message||String(t))}finally{m(!1)}})()},[]),f)return e.jsx("div",{className:"p-8",children:"Chargement des données..."});if(n)return e.jsxs("div",{className:"p-8 text-red-500",children:["Erreur: ",n]});const u=Object.values(p);return e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Test - member_schedule (groupé par schedule)"}),e.jsxs(y,{onClick:()=>g("/groupes/admin"),children:[e.jsx(v,{className:"w-4 h-4 mr-2"}),"Gérer les groupes"]})]}),u.length===0&&e.jsx("p",{className:"text-gray-500",children:"Aucun enregistrement trouvé"}),u.map((s,t)=>e.jsxs("div",{className:"mb-8 border p-4 rounded",children:[e.jsxs("h2",{className:"font-semibold mb-2",children:["Schedules: ",s.schedule.type||"—",s.schedule.age_category?e.jsxs("span",{className:"ml-2 text-sm text-muted-foreground",children:["• Age: ",s.schedule.age_category]}):null,s.schedule.day?e.jsxs("span",{className:"ml-2 text-sm text-muted-foreground",children:["• Jour: ",s.schedule.day]}):null,s.schedule.start_time?e.jsxs("span",{className:"ml-2 text-sm text-muted-foreground",children:["• Début: ",s.schedule.start_time]}):null]}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["ID: ",s.schedule.id]}),e.jsxs("table",{className:"w-full table-auto border-collapse text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"border px-2 py-1 text-left",children:"Prénom"}),e.jsx("th",{className:"border px-2 py-1 text-left",children:"Nom"})]})}),e.jsx("tbody",{children:s.members.map(a=>e.jsxs("tr",{children:[e.jsx("td",{className:"border px-2 py-1",children:a.first_name}),e.jsx("td",{className:"border px-2 py-1",children:a.last_name})]},a.id))})]})]},s.schedule.id||t))]})};export{C as default};
