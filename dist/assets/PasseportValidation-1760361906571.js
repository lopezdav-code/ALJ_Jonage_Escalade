import{c as fe,r as b,t as G,j as e,L as x,am as ie,an as oe,B as C,aF as K,ao as ce,aU as de,aV as ue,aW as me,aX as pe,aY as he,aZ as xe,a_ as ge,O as U,C as E,b as _,d as L,e as A,I as R,a8 as H,g as B,T as z,a$ as Q,Q as ve,u as be,R as je,U as ye,_ as Ne,aQ as ke,n as ee,o as se,p as ae,q as le,s as O,aR as te,S as re,x as T,X as Ce,a2 as ne,ai as we}from"./index-1760361906571.js";import{C as Se}from"./chevrons-up-down-1760361906571.js";import{C as F}from"./check-circle-2-1760361906571.js";const X=fe("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]),Z=({value:m,onChange:P,required:D=!1})=>{const[v,a]=b.useState(!1),[j,l]=b.useState([]),[c,y]=b.useState(!0);b.useEffect(()=>{q()},[]);const q=async()=>{y(!0);try{const{data:f,error:N}=await G.from("members").select("id, first_name, last_name, title").order("last_name").order("first_name");if(N)throw N;l(f||[])}catch(f){console.error("Erreur lors du chargement des membres:",f)}finally{y(!1)}},g=f=>{P(f),a(!1)};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(x,{htmlFor:"validateur",children:["Nom du validateur ",D&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(ie,{open:v,onOpenChange:a,children:[e.jsx(oe,{asChild:!0,children:e.jsxs(C,{variant:"outline",role:"combobox","aria-expanded":v,className:"w-full justify-between",children:[e.jsx("span",{className:K(!m&&"text-muted-foreground"),children:m||"Sélectionner un validateur..."}),e.jsx(Se,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),e.jsx(ce,{className:"w-full p-0",align:"start",children:e.jsxs(de,{children:[e.jsx(ue,{placeholder:"Rechercher un membre..."}),e.jsx(me,{children:c?"Chargement...":"Aucun membre trouvé."}),e.jsx(pe,{children:e.jsx(he,{children:j.map(f=>{const N=`${f.first_name} ${f.last_name}`;return e.jsxs(xe,{value:N,onSelect:()=>g(N),children:[e.jsx(ge,{className:K("mr-2 h-4 w-4",m===N?"opacity-100":"opacity-0")}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:N}),f.title&&e.jsx("span",{className:"text-xs text-muted-foreground",children:f.title})]})]},f.id)})})})]})})]})]})},qe=({member:m,onSave:P,onCancel:D})=>{const{toast:v}=U(),[a,j]=b.useState(""),[l,c]=b.useState({nom:(m==null?void 0:m.last_name)||"",prenom:(m==null?void 0:m.first_name)||"",module:"",competences:{apporterAffaires:!1,respecterMoniteur:!1,respecterCamarades:!1,respecterInstallations:!1,respecterConsignes:!1,etreAttentif:!1,verifierReception:!1,nePasStationner:!1,neJamaisGrimperDessus:!1,repererDescente:!1,descendreRelache:!1,amortirReception:!1,deplacerAisance:!1,grimperPoussee:!1,solutionsVariees:!1,seConfierCorde:!1,demonstrerAisance:!1,reussirVoies:!1,progresserPoussees:!1,nePasImpressioner:!1,etreConcentre:!1,equiperSansAide:!1,realiserNoeud:!1,controlerFeuVert:!1,noeudEncordement:!1,communiquerAssureur:!1,placerMur:!1,installerCorde:!1,manipulerCorde:!1,conserverCordetendue:!1,descendreVitesse:!1,bloquerPartenaire:!1},dateValidation:"",validateur:"",observations:""}),y=(s,i)=>{c(o=>({...o,competences:{...o.competences,[i]:!o.competences[i]}}))},q=s=>{const i=s.every(o=>l.competences[o.key]);c(o=>({...o,competences:{...o.competences,...s.reduce((w,S)=>(w[S.key]=!i,w),{})}}))},g=(s,i)=>{c(o=>({...o,[s]:i}))},f=s=>{if(s.preventDefault(),!a){v({title:"Module non sélectionné",description:"Veuillez sélectionner un module à valider (Bloc ou Difficulté).",variant:"destructive"});return}if(!$(a).flatMap(r=>r.items?r.items.map(M=>M.key):r.subsections.flatMap(M=>M.items.map(h=>h.key))).every(r=>l.competences[r]===!0)){v({title:"Validation incomplète",description:`Toutes les compétences du module ${a==="bloc"?"Bloc":"Difficulté"} doivent être validées.`,variant:"destructive"});return}if(!l.dateValidation||!l.validateur){v({title:"Informations manquantes",description:"Veuillez renseigner la date de validation et le nom du validateur.",variant:"destructive"});return}const S={...l,module:a};P(S),v({title:"Passeport Blanc validé",description:`Le module ${a==="bloc"?"Bloc":"Difficulté"} du passeport blanc de ${l.prenom} ${l.nom} a été validé avec succès.`})},N=[{title:"Module éco-responsabilité",subtitle:"Validation sous forme de contrôle continu, au fil de la saison",module:"all",items:[{key:"apporterAffaires",label:"J'apporte mes affaires et porte une tenue correcte adaptée à l'escalade"},{key:"respecterMoniteur",label:"Je respecte le moniteur"},{key:"respecterCamarades",label:"Je respecte l'activité de mes camarades et ne les distrais pas"},{key:"respecterInstallations",label:"Je respecte les installations et les autres utilisateurs de la salle"},{key:"respecterConsignes",label:"Je respecte les consignes et les règles"},{key:"etreAttentif",label:"Je suis attentif pendant les explications"}]},{title:"Module bloc",subtitle:"En salle de bloc, en pan, au départ des voies d'une SAE à corde ou sur des blocs naturels adaptés à l'initiation",module:"bloc",subsections:[{subtitle:"1. Avant chaque escalade",items:[{key:"verifierReception",label:"Je vérifie que la surface de réception n'est pas encombrée"},{key:"nePasStationner",label:"Dans l'attente de mon tour, je ne stationne pas sous un bloc"},{key:"neJamaisGrimperDessus",label:"Je ne grimpe jamais au-dessus ou au-dessous d'un autre grimpeur"}]},{subtitle:"2. Montée-descente d'un bloc",items:[{key:"repererDescente",label:"Je repère une voie de descente très facile"},{key:"descendreRelache",label:"Je descends relâché"}]},{subtitle:"3. Montée et saut, réception amortie",items:[{key:"amortirReception",label:"J'amortis de manière tonique la réception d'un saut (pieds à 20 cm du sol)"}]},{subtitle:"4. Déplacements en toutes directions (avec une grande densité de prises)",items:[{key:"deplacerAisance",label:"En toutes prises, je me déplace avec aisance dans toutes les directions en utilisant des réponses variées (petits pas, grands pas, de face, de profil, m-m-p-p, m-p-m-p…)"}]},{subtitle:"5. Démonstration des qualités de réalisation suivantes",items:[{key:"grimperPoussee",label:"En montée, en dalle d'inclinaison positive ou verticale, je grimpe à base de poussée d'une ou 2 jambes (et non de tractions), en 4-3-4 appuis ou moins"},{key:"solutionsVariees",label:"En traversée, en dalle d'inclinaison positive, je mets en œuvre des solutions variées au niveau des pieds (écart-rapprochement, croisé de pied et changement de pied)"}]}]},{title:"Module difficulté",subtitle:"En SAE à corde ou site découverte, voies en moulinette. Validation lors d'un test final.",module:"difficulte",subsections:[{subtitle:"Test de prise en charge (le grimpeur monte à faible hauteur, se fait prendre en charge par l'assureur et descend assis dans son harnais, relâché)",items:[{key:"seConfierCorde",label:"Je me confie à la corde après avoir vérifié que l'assureur m'a pris en charge"},{key:"demonstrerAisance",label:"Je démontre alors mon aisance (petit saut, pendule…)"}]},{subtitle:"Dans 3 voies sur 4 proposées, de niveau 4b et de styles variés",items:[{key:"reussirVoies",label:"Je réussis avec aisance 3 voies au 1er essai"},{key:"progresserPoussees",label:"En progressant à base de poussées de jambes (et non de tractions)"},{key:"nePasImpressioner",label:"Sans me laisser impressionner par la hauteur (je continue jusqu'au sommet sans m'arrêter de longs moments pour me rassurer et je ne dépense pas 10 fois plus d'énergie qu'il n'en faudrait…)"}]}]},{title:"Module sécurité",module:"all",subsections:[{subtitle:"1. Attitude",items:[{key:"etreConcentre",label:"Je suis concentré et reste vigilant quand je réalise une technique de sécurité"}]},{subtitle:"2. Équipement",items:[{key:"equiperSansAide",label:"Je m'équipe sans aide et sans erreur : sangles non vrillées, au-dessus des vêtements, sangle de taille serrée au-dessus des hanches"}]},{subtitle:"3. Avec mon partenaire",items:[{key:"realiserNoeud",label:"Je réalise le nœud en bout de corde"},{key:"controlerFeuVert",label:"Je contrôle tout bien et j'attends le feu vert du cadre"}]},{subtitle:"4. En situation de grimpeur (voir aussi contrôles et feux verts)",items:[{key:"noeudEncordement",label:"Je réalise mon nœud d'encordement sans aide en respectant les critères de réussite habituels: la corde passe derrière les bons passants, le huit est correctement tressé et serre les passants, le nœud d'arrêt est collé au 8"},{key:"communiquerAssureur",label:"En haut de voie (ou en cas de pb), je communique avec l'assureur"}]},{subtitle:"5. En situation d'assureur (voir aussi contrôles et feux verts), qualité de l'assurage pendant le test de prise en charge et l'assurage d'un partenaire de même poids",items:[{key:"placerMur",label:"Je me place près du mur, légèrement décalé à droite ou à gauche de la voie"},{key:"installerCorde",label:"J'installe la corde correctement dans le frein d'assurage, attache le mousqueton sur le pontet et verrouille la sécurité du mousqueton"},{key:"manipulerCorde",label:"Je manipule la corde sans hésitation et de manière à toujours conserver une main derrière le frein"},{key:"conserverCordetendue",label:"À la montée, je conserve la corde tendue, sans treuiller mon partenaire"},{key:"descendreVitesse",label:"Je descends mon partenaire à vitesse modérée sans laisser la corde filer entre mes mains et en conservant toujours une main derrière le frein"},{key:"bloquerPartenaire",label:"Je bloque mon partenaire (sensiblement de même poids) à la demande (ou en cas de chute) sans être déséquilibré"}]}]}],$=s=>s?N.filter(i=>i.module===s||i.module==="all"):[],n=a?$(a):[],d=n.flatMap(s=>s.items?s.items.map(i=>i.key):s.subsections.flatMap(i=>i.items.map(o=>o.key))),p=d.filter(s=>l.competences[s]).length,u=d.length,V=a&&d.every(s=>l.competences[s]===!0);return e.jsx("div",{className:"max-w-4xl mx-auto p-6",children:e.jsxs(E,{children:[e.jsxs(_,{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:[e.jsxs(L,{className:"text-2xl flex items-center gap-2",children:[e.jsx(F,{className:"w-8 h-8"}),"Validation du Passeport Blanc"]}),e.jsx("p",{className:"text-sm mt-2 text-blue-100",children:"Sélectionnez le module à valider : Bloc (salle de bloc) ou Difficulté (salle d'escalade)"})]}),e.jsx(A,{className:"p-6",children:e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-lg mb-4",children:"Informations du grimpeur"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"nom",children:"Nom"}),e.jsx(R,{id:"nom",value:l.nom,onChange:s=>g("nom",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"prenom",children:"Prénom"}),e.jsx(R,{id:"prenom",value:l.prenom,onChange:s=>g("prenom",s.target.value),required:!0})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-cyan-50 p-6 rounded-lg border-2 border-blue-200",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[e.jsx(H,{className:"w-5 h-5 text-blue-600"}),"Sélectionnez le module à valider"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(C,{type:"button",variant:a==="bloc"?"default":"outline",className:`h-auto py-6 flex flex-col gap-2 ${a==="bloc"?"bg-blue-600 hover:bg-blue-700":""}`,onClick:()=>j("bloc"),children:[e.jsx("span",{className:"text-2xl",children:"🧗"}),e.jsx("span",{className:"font-semibold text-base",children:"Module Bloc"}),e.jsx("span",{className:"text-xs opacity-90",children:"Salle de bloc"})]}),e.jsxs(C,{type:"button",variant:a==="difficulte"?"default":"outline",className:`h-auto py-6 flex flex-col gap-2 ${a==="difficulte"?"bg-blue-600 hover:bg-blue-700":""}`,onClick:()=>j("difficulte"),children:[e.jsx("span",{className:"text-2xl",children:"🧗‍♀️"}),e.jsx("span",{className:"font-semibold text-base",children:"Module Difficulté"}),e.jsx("span",{className:"text-xs opacity-90",children:"Salle d'escalade à cordes"})]})]})]}),a&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-semibold",children:["Progression - Module ",a==="bloc"?"Bloc":"Difficulté"]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[p," / ",u," compétences validées"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full transition-all ${V?"bg-green-500":"bg-blue-500"}`,style:{width:`${u>0?p/u*100:0}%`}})})]}),a&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Compétences à valider"}),n.map((s,i)=>{var S;const o=s.items?s.items:((S=s.subsections)==null?void 0:S.flatMap(r=>r.items))||[],w=o.every(r=>l.competences[r.key]);return e.jsxs(E,{className:"border-l-4 border-l-blue-500",children:[e.jsx(_,{className:"pb-3",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-semibold text-blue-700",children:s.title}),e.jsxs(C,{type:"button",variant:w?"outline":"default",size:"sm",onClick:()=>q(o),className:"gap-2",children:[e.jsx(X,{className:"w-4 h-4"}),w?"Tout décocher":"Tout cocher"]})]}),s.subtitle&&e.jsx("p",{className:"text-sm text-gray-600 italic",children:s.subtitle})]})}),e.jsxs(A,{className:"space-y-4",children:[s.items&&s.items.map(r=>e.jsxs("div",{className:"flex items-start gap-3 p-2 hover:bg-gray-50 rounded",children:[e.jsx(B,{id:`competence-${r.key}`,checked:l.competences[r.key],onCheckedChange:()=>y(s.title,r.key)}),e.jsx(x,{htmlFor:`competence-${r.key}`,className:`cursor-pointer flex-1 ${l.competences[r.key]?"text-green-700 line-through":""}`,children:r.label}),l.competences[r.key]&&e.jsx(F,{className:"w-5 h-5 text-green-500 flex-shrink-0"})]},r.key)),s.subsections&&s.subsections.map((r,M)=>e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"font-medium text-blue-600 text-sm mt-2",children:r.subtitle}),r.items.map(h=>e.jsxs("div",{className:"flex items-start gap-3 p-2 hover:bg-gray-50 rounded ml-4",children:[e.jsx(B,{id:`competence-${h.key}`,checked:l.competences[h.key],onCheckedChange:()=>y(s.title,h.key)}),e.jsx(x,{htmlFor:`competence-${h.key}`,className:`cursor-pointer flex-1 text-sm ${l.competences[h.key]?"text-green-700 line-through":""}`,children:h.label}),l.competences[h.key]&&e.jsx(F,{className:"w-5 h-5 text-green-500 flex-shrink-0"})]},h.key))]},M))]})]},i)})]}),a&&e.jsxs("div",{children:[e.jsx(x,{htmlFor:"observations",children:"Observations (optionnel)"}),e.jsx(z,{id:"observations",value:l.observations,onChange:s=>g("observations",s.target.value),placeholder:"Points forts, axes de progression, remarques...",rows:4})]}),a&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx(x,{htmlFor:"observations",children:"Commentaire (optionnel)"}),e.jsx(z,{id:"observations",placeholder:"Ajoutez un commentaire sur la validation (points forts, axes d'amélioration...)",value:l.observations,onChange:s=>g("observations",s.target.value),rows:3})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg space-y-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Validation finale"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"dateValidation",children:"Date de validation *"}),e.jsx(R,{id:"dateValidation",type:"date",value:l.dateValidation,onChange:s=>g("dateValidation",s.target.value),required:!0})]}),e.jsx(Z,{value:l.validateur,onChange:s=>g("validateur",s),required:!0})]})]})]}),e.jsxs("div",{className:"flex gap-4 justify-end pt-4 border-t",children:[e.jsx(C,{type:"button",variant:"outline",onClick:D,children:"Annuler"}),e.jsx(C,{type:"submit",className:V?"bg-green-600 hover:bg-green-700":"",disabled:!V||!a,children:V?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Valider le Module ",a==="bloc"?"Bloc":"Difficulté"]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),a?"Compléter toutes les compétences":"Sélectionner un module"]})})]})]})})]})})},Ve=({member:m,onSave:P,onCancel:D})=>{const{toast:v}=U(),[a,j]=b.useState(""),[l,c]=b.useState({nom:(m==null?void 0:m.last_name)||"",prenom:(m==null?void 0:m.first_name)||"",module:"",competences:{preserverIntegrite:!1,eviterGaspillage:!1,prendreSoinMateriel:!1,respecterConsignes:!1,connaitreRegles:!1,connaitreZones:!1,verifierTapis:!1,apprecierHauteurs:!1,anticiperChute:!1,privilegierDesescalade:!1,monterRedescendre:!1,amortirSaut:!1,reussirPoussees:!1,repererChangements:!1,solutionsVarieesPieds:!1,realisationDalle:!1,communiquerAssureur:!1,seConfierCorde:!1,reussirVoies:!1,nePasImpressioner:!1,utiliserMouvements:!1,etreConcentre:!1,realiserNoeud:!1,controlerFeuVert:!1,attentionJambe:!1,trouverPosition:!1,mousquetonnerDegaines:!1,choisirDescente:!1,preparerCorde:!1,placerMur:!1,donnerReprendreMou:!1,bloquerPartenaire:!1,communiquerProbleme:!1},dateValidation:"",validateur:"",observations:""}),y=(s,i)=>{c(o=>({...o,competences:{...o.competences,[i]:!o.competences[i]}}))},q=s=>{const i=s.every(o=>l.competences[o.key]);c(o=>({...o,competences:{...o.competences,...s.reduce((w,S)=>(w[S.key]=!i,w),{})}}))},g=(s,i)=>{c(o=>({...o,[s]:i}))},f=s=>{if(s.preventDefault(),!a){v({title:"Module non sélectionné",description:"Veuillez sélectionner un module à valider (Bloc ou Difficulté).",variant:"destructive"});return}if(!$(a).flatMap(r=>r.items?r.items.map(M=>M.key):r.subsections.flatMap(M=>M.items.map(h=>h.key))).every(r=>l.competences[r]===!0)){v({title:"Validation incomplète",description:`Toutes les compétences du module ${a==="bloc"?"Bloc":"Difficulté"} doivent être validées.`,variant:"destructive"});return}if(!l.dateValidation||!l.validateur){v({title:"Informations manquantes",description:"Veuillez renseigner la date de validation et le nom du validateur.",variant:"destructive"});return}const S={...l,module:a};P(S),v({title:"Passeport Jaune validé",description:`Le module ${a==="bloc"?"Bloc":"Difficulté"} du passeport jaune de ${l.prenom} ${l.nom} a été validé avec succès.`})},N=[{title:"Module éco-responsabilité",subtitle:"Pendant la session",module:"all",items:[{key:"preserverIntegrite",label:"Je préserve l'intégrité et la propreté de la salle"},{key:"eviterGaspillage",label:"J'évite tout gaspillage"},{key:"prendreSoinMateriel",label:"Je prends soin du matériel"},{key:"respecterConsignes",label:"Je respecte les consignes et les règles"}]},{title:"Module bloc",subtitle:"En salle de bloc, en pan, au départ des voies d'une SAE à corde ou sur des blocs naturels adaptés à l'initiation. Validation test final : blocs faciles de niveau 4a",module:"bloc",subsections:[{subtitle:"1. Principes généraux de sécurité",items:[{key:"connaitreRegles",label:"En salle, je connais et j'applique les règles de sécurité affichées"},{key:"connaitreZones",label:"Je connais les zones possibles de circulation et de stationnement lorsque je ne grimpe pas"}]},{subtitle:"2. En début de séance (selon la salle)",items:[{key:"verifierTapis",label:"Je vérifie l'agencement des tapis"}]},{subtitle:"3. Montée-descente des blocs",items:[{key:"apprecierHauteurs",label:"Je suis capable d'apprécier les hauteurs à ne pas dépasser"},{key:"anticiperChute",label:"Je sais anticiper la manière dont je vais chuter et la zone de réception"},{key:"privilegierDesescalade",label:"Je privilégie la désescalade, si possible par un itinéraire de descente"},{key:"monterRedescendre",label:"Je monte et redescends 3 blocs faciles"}]},{subtitle:"4. Montée et saut, réception amortie",items:[{key:"amortirSaut",label:"En SAE, j'amortis de manière tonique la réception d'un saut (pieds à 50 cm du sol) et enchaîne avec une chute arrière ou un roulé-boulé"}]},{subtitle:"5. Réussite avec aisance de blocs faciles, induisant les réponses suivantes, en montée, dans des passages verticaux",items:[{key:"reussirPoussees",label:"Je réussi des passages induisant des poussées sur une ou deux jambes"},{key:"repererChangements",label:"Je repère et réalise les passages induisant changements de pied et de main, voire légers croisés de main"}]},{subtitle:"6. Démonstration des qualités de réalisation suivantes",items:[{key:"solutionsVarieesPieds",label:"En traversée, dans des passages verticaux, je mets en œuvre des solutions variées au niveau des pieds (écart-rapprochement, croisé de pied et changement de pied)"},{key:"realisationDalle",label:"En montée, en dalle, je réalise un passage avec de petites prises pour les mains mais des prises correctes pour les pieds, à base de poussées"}]}]},{title:"Module difficulté",subtitle:"En SAE à corde (ou site découverte), voies en tête",module:"difficulte",subsections:[{subtitle:"Test de prise en charge (le grimpeur en tête se fait bloquer par l'assureur au niveau d'un point d'ancrage)",items:[{key:"communiquerAssureur",label:"Je communique avec l'assureur"},{key:"seConfierCorde",label:"Je me confie à la corde après avoir vérifié que l'assureur m'a pris en charge"}]},{subtitle:"Dans 3 voies sur 4 proposées, pas forcément à vue, de niveau 5b et de styles variés",items:[{key:"reussirVoies",label:"Je réussis avec aisance 3 voies au 1er essai"},{key:"nePasImpressioner",label:"Sans me laisser impressionner par la hauteur et le risque de chute (contre-exemple : serrer les prises, hésiter longuement…)"},{key:"utiliserMouvements",label:"En utilisant les mouvements de base (ne pas rester en grimpe main-main-pied-pied)"}]}]},{title:"Module sécurité",module:"all",subsections:[{subtitle:"1. Attitude",items:[{key:"etreConcentre",label:"Je suis concentré et reste vigilant quand je réalise une technique de sécurité"}]},{subtitle:"2. Avec mon partenaire",items:[{key:"realiserNoeud",label:"Je réalise le nœud en bout de corde"},{key:"controlerFeuVert",label:"Je contrôle tout bien et j'attends le feu vert du cadre"}]},{subtitle:"3. En situation de grimpeur (voir aussi contrôles et feux verts)",items:[{key:"attentionJambe",label:"Je fais attention à ne pas laisser ma jambe derrière la corde"},{key:"trouverPosition",label:"Je trouve une position confortable pour mousquetonner"},{key:"mousquetonnerDegaines",label:"Je mousquetonne toutes les dégaines, dans le bon sens"},{key:"choisirDescente",label:"En haut de voie, je choisis un système de descente libre, place correctement ma corde dedans et communique avec l'assureur avant de me confier à la corde"}]},{subtitle:"4. En situation d'assureur (voir aussi contrôles et feux verts), pendant le test de prise en charge et l'assurage des 3-4 voies d'un partenaire",items:[{key:"preparerCorde",label:"Je prépare la corde pour qu'elle vienne sans nœud"},{key:"placerMur",label:"Je me place près du mur, légèrement décalé à droite ou à gauche de la voie et éventuellement après le 3ème point d'ancrage, je me recule pour suivre la progression du grimpeur"},{key:"donnerReprendreMou",label:"Je donne la corde et reprend le mou en fonction des besoins du grimpeur"},{key:"bloquerPartenaire",label:"Je bloque mon partenaire (sensiblement de même poids) au niveau d'un point d'ancrage (ou en cas de chute) sans être déséquilibré"},{key:"communiquerProbleme",label:"En cas de problème, je communique avec le grimpeur"}]}]}],$=s=>s?N.filter(i=>i.module===s||i.module==="all"):[],n=a?$(a):[],d=n.flatMap(s=>s.items?s.items.map(i=>i.key):s.subsections.flatMap(i=>i.items.map(o=>o.key))),p=d.filter(s=>l.competences[s]).length,u=d.length,V=a&&d.every(s=>l.competences[s]===!0);return e.jsx("div",{className:"max-w-4xl mx-auto p-6",children:e.jsxs(E,{children:[e.jsxs(_,{className:"bg-gradient-to-r from-yellow-500 to-yellow-600 text-white",children:[e.jsxs(L,{className:"text-2xl flex items-center gap-2",children:[e.jsx(F,{className:"w-8 h-8"}),"Validation du Passeport Jaune"]}),e.jsx("p",{className:"text-sm mt-2 text-yellow-100",children:"Sélectionnez le module à valider : Bloc (salle de bloc) ou Difficulté (salle d'escalade)"})]}),e.jsx(A,{className:"p-6",children:e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-lg mb-4",children:"Informations du grimpeur"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"nom",children:"Nom"}),e.jsx(R,{id:"nom",value:l.nom,onChange:s=>g("nom",s.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"prenom",children:"Prénom"}),e.jsx(R,{id:"prenom",value:l.prenom,onChange:s=>g("prenom",s.target.value),required:!0})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-yellow-50 to-amber-50 p-6 rounded-lg border-2 border-yellow-200",children:[e.jsxs("h3",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[e.jsx(H,{className:"w-5 h-5 text-yellow-600"}),"Sélectionnez le module à valider"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs(C,{type:"button",variant:a==="bloc"?"default":"outline",className:`h-auto py-6 flex flex-col gap-2 ${a==="bloc"?"bg-yellow-600 hover:bg-yellow-700":""}`,onClick:()=>j("bloc"),children:[e.jsx("span",{className:"text-2xl",children:"🧗"}),e.jsx("span",{className:"font-semibold text-base",children:"Module Bloc"}),e.jsx("span",{className:"text-xs opacity-90",children:"Salle de bloc"})]}),e.jsxs(C,{type:"button",variant:a==="difficulte"?"default":"outline",className:`h-auto py-6 flex flex-col gap-2 ${a==="difficulte"?"bg-yellow-600 hover:bg-yellow-700":""}`,onClick:()=>j("difficulte"),children:[e.jsx("span",{className:"text-2xl",children:"🧗‍♀️"}),e.jsx("span",{className:"font-semibold text-base",children:"Module Difficulté"}),e.jsx("span",{className:"text-xs opacity-90",children:"Salle d'escalade à cordes"})]})]})]}),a&&e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"font-semibold",children:["Progression - Module ",a==="bloc"?"Bloc":"Difficulté"]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[p," / ",u," compétences validées"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full transition-all ${V?"bg-green-500":"bg-yellow-500"}`,style:{width:`${u>0?p/u*100:0}%`}})})]}),a&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Compétences à valider"}),n.map((s,i)=>{var S;const o=s.items?s.items:((S=s.subsections)==null?void 0:S.flatMap(r=>r.items))||[],w=o.every(r=>l.competences[r.key]);return e.jsxs(E,{className:"border-l-4 border-l-yellow-500",children:[e.jsx(_,{className:"pb-3",children:e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-semibold text-yellow-700",children:s.title}),e.jsxs(C,{type:"button",variant:w?"outline":"default",size:"sm",onClick:()=>q(o),className:"gap-2",children:[e.jsx(X,{className:"w-4 h-4"}),w?"Tout décocher":"Tout cocher"]})]}),s.subtitle&&e.jsx("p",{className:"text-sm text-gray-600 italic",children:s.subtitle})]})}),e.jsxs(A,{className:"space-y-4",children:[s.items&&s.items.map(r=>e.jsxs("div",{className:"flex items-start gap-3 p-2 hover:bg-gray-50 rounded",children:[e.jsx(B,{id:`competence-${r.key}`,checked:l.competences[r.key],onCheckedChange:()=>y(s.title,r.key)}),e.jsx(x,{htmlFor:`competence-${r.key}`,className:`cursor-pointer flex-1 ${l.competences[r.key]?"text-green-700 line-through":""}`,children:r.label}),l.competences[r.key]&&e.jsx(F,{className:"w-5 h-5 text-green-500 flex-shrink-0"})]},r.key)),s.subsections&&s.subsections.map((r,M)=>e.jsxs("div",{className:"space-y-3",children:[e.jsx("h5",{className:"font-medium text-yellow-600 text-sm mt-2",children:r.subtitle}),r.items.map(h=>e.jsxs("div",{className:"flex items-start gap-3 p-2 hover:bg-gray-50 rounded ml-4",children:[e.jsx(B,{id:`competence-${h.key}`,checked:l.competences[h.key],onCheckedChange:()=>y(s.title,h.key)}),e.jsx(x,{htmlFor:`competence-${h.key}`,className:`cursor-pointer flex-1 text-sm ${l.competences[h.key]?"text-green-700 line-through":""}`,children:h.label}),l.competences[h.key]&&e.jsx(F,{className:"w-5 h-5 text-green-500 flex-shrink-0"})]},h.key))]},M))]})]},i)})]}),a&&e.jsxs("div",{children:[e.jsx(x,{htmlFor:"observations",children:"Observations (optionnel)"}),e.jsx(z,{id:"observations",value:l.observations,onChange:s=>g("observations",s.target.value),placeholder:"Points forts, axes de progression, remarques...",rows:4})]}),a&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx(x,{htmlFor:"observations",children:"Commentaire (optionnel)"}),e.jsx(z,{id:"observations",placeholder:"Ajoutez un commentaire sur la validation (points forts, axes d'amélioration...)",value:l.observations,onChange:s=>g("observations",s.target.value),rows:3})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg space-y-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Validation finale"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"dateValidation",children:"Date de validation *"}),e.jsx(R,{id:"dateValidation",type:"date",value:l.dateValidation,onChange:s=>g("dateValidation",s.target.value),required:!0})]}),e.jsx(Z,{value:l.validateur,onChange:s=>g("validateur",s),required:!0})]})]})]}),e.jsxs("div",{className:"flex gap-4 justify-end pt-4 border-t",children:[e.jsx(C,{type:"button",variant:"outline",onClick:D,children:"Annuler"}),e.jsx(C,{type:"submit",className:V?"bg-green-600 hover:bg-green-700":"",disabled:!V||!a,children:V?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Valider le Module ",a==="bloc"?"Bloc":"Difficulté"]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),a?"Compléter toutes les compétences":"Sélectionner un module"]})})]})]})})]})})},Me=({member:m,onSave:P,onCancel:D})=>{const{toast:v}=U(),[a,j]=b.useState({nom:(m==null?void 0:m.last_name)||"",prenom:(m==null?void 0:m.first_name)||"",competences:{choisirSite:!1,verifierMeteo:!1,preparerMateriel:!1,evaluerNiveau:!1,planifierSortie:!1,choisirEquipement:!1,controlerMateriel:!1,enfilerBaudrier:!1,faireEncordement:!1,preparerRelais:!1,grimperTete:!1,clipperCorrectement:!1,gererCorde:!1,evaluerItineraire:!1,gererEffort:!1,assurerTete:!1,gererMou:!1,pararChute:!1,installerRelais:!1,mouflageSecours:!1,choisirEmplacement:!1,installerAnneaux:!1,triangulation:!1,verifierSolidite:!1,communiquerRelais:!1,respecterReglementation:!1,connaitreAcces:!1,preserverEnvironnement:!1,gererDechets:!1,respecterAutresUsagers:!1},dateValidation:"",validateur:"",observations:""}),l=(n,d)=>{j(p=>({...p,competences:{...p.competences,[d]:!p.competences[d]}}))},c=n=>{const d=n.every(p=>a.competences[p.key]);j(p=>({...p,competences:{...p.competences,...n.reduce((u,V)=>(u[V.key]=!d,u),{})}}))},y=(n,d)=>{j(p=>({...p,[n]:d}))},q=n=>{if(n.preventDefault(),!Object.values(a.competences).every(p=>p===!0)){v({title:"Validation incomplète",description:"Toutes les compétences doivent être validées pour obtenir le passeport orange.",variant:"destructive"});return}if(!a.dateValidation||!a.validateur){v({title:"Informations manquantes",description:"Veuillez renseigner la date de validation et le nom du validateur.",variant:"destructive"});return}P(a),v({title:"Passeport Orange validé",description:`Le passeport orange de ${a.prenom} ${a.nom} a été validé avec succès.`})},g=[{title:"1. Préparer une sortie en falaise école",items:[{key:"choisirSite",label:"Choisir un site adapté à son niveau"},{key:"verifierMeteo",label:"Vérifier les conditions météorologiques"},{key:"preparerMateriel",label:"Préparer le matériel nécessaire (corde, dégaines, casque...)"},{key:"evaluerNiveau",label:"Évaluer le niveau de difficulté des voies"},{key:"planifierSortie",label:"Planifier l'horaire et l'organisation de la sortie"}]},{title:"2. S'équiper pour grimper en falaise",items:[{key:"choisirEquipement",label:"Choisir l'équipement adapté (chaussons, baudrier, casque)"},{key:"controlerMateriel",label:"Contrôler l'état du matériel avant utilisation"},{key:"enfilerBaudrier",label:"Enfiler correctement son baudrier et son casque"},{key:"faireEncordement",label:"Faire son encordement (nœud de huit)"},{key:"preparerRelais",label:"Préparer ses dégaines et son matériel de relais"}]},{title:"3. Grimper en tête en falaise école",items:[{key:"grimperTete",label:"Grimper en tête sur voie équipée"},{key:"clipperCorrectement",label:"Clipper correctement dans les dégaines"},{key:"gererCorde",label:"Gérer sa corde (éviter les frottements, tirage)"},{key:"evaluerItineraire",label:"Évaluer et choisir son itinéraire"},{key:"gererEffort",label:"Gérer son effort et ses points de repos"}]},{title:"4. Assurer un grimpeur en falaise",items:[{key:"assurerTete",label:"Assurer un grimpeur en tête"},{key:"gererMou",label:"Gérer le mou de corde"},{key:"pararChute",label:"Parer une éventuelle chute"},{key:"installerRelais",label:"Installer un relais en tête de voie"},{key:"mouflageSecours",label:"Connaître les techniques de mouflage et secours de base"}]},{title:"5. Installer et vérifier un relais",items:[{key:"choisirEmplacement",label:"Choisir un bon emplacement de relais"},{key:"installerAnneaux",label:"Installer des anneaux de sangle ou utiliser les points en place"},{key:"triangulation",label:"Réaliser une triangulation correcte"},{key:"verifierSolidite",label:"Vérifier la solidité du relais"},{key:"communiquerRelais",label:"Communiquer clairement lors de l'installation du relais"}]},{title:"6. Connaître la réglementation et l'environnement",items:[{key:"respecterReglementation",label:"Respecter la réglementation locale (accès, horaires)"},{key:"connaitreAcces",label:"Connaître les voies d'accès et parkings"},{key:"preserverEnvironnement",label:"Préserver l'environnement naturel"},{key:"gererDechets",label:"Gérer ses déchets et ne rien laisser sur place"},{key:"respecterAutresUsagers",label:"Respecter les autres usagers du site"}]}],f=Object.values(a.competences).every(n=>n===!0),N=Object.values(a.competences).filter(n=>n).length,$=Object.values(a.competences).length;return e.jsx("div",{className:"max-w-4xl mx-auto p-6",children:e.jsxs(E,{children:[e.jsxs(_,{className:"bg-gradient-to-r from-orange-500 to-orange-600 text-white",children:[e.jsxs(L,{className:"text-2xl flex items-center gap-2",children:[e.jsx(F,{className:"w-8 h-8"}),"Validation du Passeport Orange"]}),e.jsx("p",{className:"text-sm mt-2 text-orange-100",children:"Le passeport orange valide les compétences pour grimper en autonomie sur SAE"})]}),e.jsx(A,{className:"p-6",children:e.jsxs("form",{onSubmit:q,className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-lg mb-4",children:"Informations du grimpeur"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"nom",children:"Nom"}),e.jsx(R,{id:"nom",value:a.nom,onChange:n=>y("nom",n.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"prenom",children:"Prénom"}),e.jsx(R,{id:"prenom",value:a.prenom,onChange:n=>y("prenom",n.target.value),required:!0})]})]})]}),e.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-semibold",children:"Progression"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[N," / ",$," compétences validées"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full transition-all ${f?"bg-green-500":"bg-orange-500"}`,style:{width:`${N/$*100}%`}})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Compétences à valider"}),g.map((n,d)=>{const p=n.items.every(u=>a.competences[u.key]);return e.jsxs(E,{className:"border-l-4 border-l-orange-500",children:[e.jsx(_,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-semibold text-orange-700",children:n.title}),e.jsxs(C,{type:"button",variant:p?"outline":"default",size:"sm",onClick:()=>c(n.items),className:"gap-2",children:[e.jsx(X,{className:"w-4 h-4"}),p?"Tout décocher":"Tout cocher"]})]})}),e.jsx(A,{className:"space-y-3",children:n.items.map(u=>e.jsxs("div",{className:"flex items-start gap-3 p-2 hover:bg-gray-50 rounded",children:[e.jsx(B,{id:`competence-${u.key}`,checked:a.competences[u.key],onCheckedChange:()=>l(n.title,u.key)}),e.jsx(x,{htmlFor:`competence-${u.key}`,className:`cursor-pointer flex-1 ${a.competences[u.key]?"text-green-700 line-through":""}`,children:u.label}),a.competences[u.key]&&e.jsx(F,{className:"w-5 h-5 text-green-500 flex-shrink-0"})]},u.key))})]},d)})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx(x,{htmlFor:"observations",children:"Commentaire (optionnel)"}),e.jsx(z,{id:"observations",value:a.observations,onChange:n=>y("observations",n.target.value),placeholder:"Ajoutez un commentaire sur la validation (points forts, axes d'amélioration...)",rows:3})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg space-y-4",children:[e.jsx("h3",{className:"font-semibold text-lg",children:"Validation finale"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"dateValidation",children:"Date de validation *"}),e.jsx(R,{id:"dateValidation",type:"date",value:a.dateValidation,onChange:n=>y("dateValidation",n.target.value),required:!0})]}),e.jsx(Z,{value:a.validateur,onChange:n=>y("validateur",n),required:!0})]})]}),e.jsxs("div",{className:"flex gap-4 justify-end pt-4 border-t",children:[e.jsx(C,{type:"button",variant:"outline",onClick:D,children:"Annuler"}),e.jsx(C,{type:"submit",className:f?"bg-green-600 hover:bg-green-700":"",disabled:!f,children:f?e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Valider le Passeport Orange"]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Compléter toutes les compétences"]})})]})]})})]})})},Ae=()=>{var W;const{isAdmin:m}=ve(),{toast:P}=U(),D=be(),[v,a]=b.useState([]),[j,l]=b.useState([]),[c,y]=b.useState(null),[q,g]=b.useState(""),[f,N]=b.useState(!0),[$,n]=b.useState(!1),[d,p]=b.useState("all"),[u,V]=b.useState(""),[s,i]=b.useState(!1),o=[{value:"all",label:"Tous les membres"},{value:"Loisir enfants",label:"Loisir enfants"},{value:"Loisir collége",label:"Loisir collège"},{value:"Loisir lycée",label:"Loisir lycée"},{value:"Loisir adulte",label:"Loisir adulte"}];b.useEffect(()=>{w()},[]),b.useEffect(()=>{let t=v;if(d!=="all"&&(t=t.filter(k=>k.title===d)),u.trim()){const k=u.toLowerCase().trim();t=t.filter(J=>{var I,Y;return((I=J.first_name)==null?void 0:I.toLowerCase().includes(k))||((Y=J.last_name)==null?void 0:Y.toLowerCase().includes(k))||`${J.first_name} ${J.last_name}`.toLowerCase().includes(k)||`${J.last_name} ${J.first_name}`.toLowerCase().includes(k)})}l(t)},[v,d,u]);const w=async()=>{N(!0);try{const{data:t,error:k}=await G.from("members").select("*").in("title",["Loisir enfants","Loisir collége","Loisir lycée","Loisir adulte"]).order("last_name").order("first_name");if(k)throw k;a(t||[]),l(t||[])}catch{P({title:"Erreur",description:"Impossible de charger la liste des membres",variant:"destructive"})}finally{N(!1)}},S=t=>{const k=v.find(J=>J.id===t);y(k),i(!1)},r=()=>{p("all"),V(""),y(null)},M=t=>{g(t),c&&t&&n(!0)},h=async t=>{try{const k={member_id:c.id,passeport_type:q.toLowerCase(),competences:t.competences,date_validation:t.dateValidation,validateur:t.validateur,observations:t.observations,module:t.module||null,validated_at:new Date().toISOString()},{error:J}=await G.from("passeport_validations").insert(k);if(J)throw J;const{error:I}=await G.from("members").update({passeport:q}).eq("id",c.id);if(I)throw I;P({title:"Succès",description:`Le passeport ${q.toLowerCase()} de ${c.first_name} ${c.last_name} a été validé.`}),n(!1),y(null),g(""),w()}catch(k){P({title:"Erreur",description:"Impossible de sauvegarder la validation",variant:"destructive"}),console.error("Erreur de sauvegarde:",k)}};if(!m)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("p",{className:"text-muted-foreground",children:"Accès réservé aux administrateurs"})});if(f)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(je,{className:"w-8 h-8 animate-spin text-primary"})});if($&&c&&q){const k={Blanc:qe,Jaune:Ve,Orange:Me}[q];return e.jsx(k,{member:c,onSave:h,onCancel:()=>{n(!1),y(null),g("")}})}return e.jsxs("div",{className:"space-y-6",children:[e.jsx(ye,{children:e.jsx("title",{children:"Validation des Passeports - Club d'Escalade"})}),e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(H,{className:"w-10 h-10 text-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold headline",children:"Validation des Passeports"}),e.jsx("p",{className:"text-muted-foreground",children:"Validez les passeports d'escalade de vos grimpeurs"})]})]}),e.jsxs(C,{variant:"outline",className:"flex items-center gap-2",onClick:()=>D("/passeport-viewer"),children:[e.jsx(Ne,{className:"w-4 h-4"}),"Consultation des Passeports"]})]}),e.jsxs(E,{children:[e.jsx(_,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"w-5 h-5"}),"Filtres de recherche"]})}),e.jsxs(A,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"title-filter",children:"Filtrer par catégorie"}),e.jsxs(ee,{value:d,onValueChange:p,children:[e.jsx(se,{id:"title-filter",className:"w-full",children:e.jsx(ae,{placeholder:"Sélectionner une catégorie..."})}),e.jsx(le,{children:o.map(t=>e.jsx(O,{value:t.value,children:t.label},t.value))})]})]}),e.jsxs("div",{children:[e.jsx(x,{children:"Rechercher un membre par nom ou prénom"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:d!=="all"?"Recherchez dans la catégorie sélectionnée ou consultez la liste ci-dessous":"Utilisez la recherche rapide ou sélectionnez une catégorie pour voir tous les membres"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsxs(ie,{open:s,onOpenChange:i,children:[e.jsx(oe,{asChild:!0,children:e.jsx(C,{variant:"outline",role:"combobox","aria-expanded":s,className:"w-full justify-between",children:c?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4 text-green-600"}),c.last_name," ",c.first_name]}):e.jsxs("span",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx(re,{className:"w-4 h-4"}),"Sélectionner un membre..."]})})}),e.jsx(ce,{className:"w-[400px] p-0",children:e.jsxs(de,{children:[e.jsx(ue,{placeholder:"Rechercher par nom ou prénom...",value:u,onValueChange:V}),e.jsx(me,{children:"Aucun membre trouvé."}),e.jsx(pe,{children:e.jsx(he,{heading:`${j.length} membre(s) trouvé(s)`,children:j.slice(0,50).map(t=>e.jsx(xe,{value:`${t.last_name} ${t.first_name}`,onSelect:()=>S(t.id),children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-medium",children:[t.last_name," ",t.first_name]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t.title})]}),t.passeport&&e.jsx(T,{variant:"outline",className:"ml-2",children:t.passeport})]})},t.id))})})]})})]})}),(d!=="all"||u||c)&&e.jsx(C,{variant:"outline",size:"icon",onClick:r,title:"Réinitialiser les filtres",children:e.jsx(Ce,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(ne,{className:"w-4 h-4"}),e.jsxs("span",{children:[j.length," membre(s) ",d!=="all"&&`en ${d}`]})]})]})]}),c&&e.jsxs(E,{className:"border-2 border-primary/50",children:[e.jsx(_,{className:"bg-primary/5",children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-5 h-5 text-primary"}),"Membre sélectionné"]})}),e.jsxs(A,{className:"pt-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Nom"}),e.jsx("p",{className:"font-semibold",children:c.last_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Prénom"}),e.jsx("p",{className:"font-semibold",children:c.first_name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Catégorie"}),e.jsx(T,{variant:"outline",children:c.title})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Passeport actuel"}),e.jsx(T,{className:c.passeport?"bg-green-600":"bg-gray-400",children:c.passeport||"Aucun"})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"passeport-type",children:"Type de passeport à valider"}),e.jsxs(ee,{onValueChange:M,value:q,children:[e.jsx(se,{id:"passeport-type",className:"w-full",children:e.jsx(ae,{placeholder:"Sélectionner un type de passeport..."})}),e.jsxs(le,{children:[e.jsx(O,{value:"Blanc",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-white border-2 border-gray-400 rounded-full"}),e.jsx("span",{children:"Passeport Blanc - Moulinette autonome"})]})}),e.jsx(O,{value:"Jaune",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-yellow-400 rounded-full"}),e.jsx("span",{children:"Passeport Jaune - Grimpe en tête"})]})}),e.jsx(O,{value:"Orange",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 bg-orange-500 rounded-full"}),e.jsx("span",{children:"Passeport Orange - Autonomie SAE"})]})})]})]})]})]})]}),!c&&j.length>0&&e.jsxs(E,{children:[e.jsx(_,{children:e.jsxs(L,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"w-5 h-5"}),d!=="all"?e.jsxs("span",{children:["Membres - ",(W=o.find(t=>t.value===d))==null?void 0:W.label]}):e.jsx("span",{children:"Tous les membres"})]}),e.jsx(T,{variant:"secondary",className:"text-lg",children:j.length})]})}),e.jsx(A,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:j.map(t=>e.jsx(E,{className:"cursor-pointer hover:shadow-lg hover:border-primary transition-all duration-200 group",onClick:()=>S(t.id),children:e.jsx(A,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center group-hover:bg-primary/20 transition-colors",children:e.jsx(we,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-lg truncate group-hover:text-primary transition-colors",children:t.last_name}),e.jsx("p",{className:"text-sm text-muted-foreground truncate",children:t.first_name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx(T,{variant:"outline",className:"text-xs",children:t.title}),t.passeport&&e.jsx(T,{className:K("text-xs",t.passeport==="Blanc"&&"bg-white border-2 border-gray-400 text-gray-800",t.passeport==="Jaune"&&"bg-yellow-400 text-gray-900",t.passeport==="Orange"&&"bg-orange-500 text-white",t.passeport==="Rouge"&&"bg-red-500 text-white"),children:t.passeport})]})]})]})})},t.id))})})]}),!c&&j.length===0&&e.jsx(E,{className:"border-dashed",children:e.jsxs(A,{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(re,{className:"w-12 h-12 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg font-semibold text-muted-foreground",children:"Aucun membre trouvé"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Essayez de modifier vos critères de recherche"})]})})]})};export{Ae as default};
