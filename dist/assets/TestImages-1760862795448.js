import{r,j as e,bd as d,y as m}from"./index-1760862795448.js";const u=()=>{const[s,a]=r.useState([]),[i,n]=r.useState(!0);return r.useEffect(()=>{(async()=>{const{data:c,error:o}=await m.from("secure_members").select("id, first_name, last_name, photo_url").not("photo_url","is",null).limit(5);o?console.error("Erreur chargement membres:",o):(console.log("Membres avec photos:",c),a(c||[])),n(!1)})()},[]),i?e.jsx("div",{className:"p-8",children:"Chargement..."}):e.jsxs("div",{className:"p-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Test des images membres"}),e.jsx("div",{className:"space-y-8",children:s.map(l=>e.jsx(x,{member:l},l.id))}),s.length===0&&e.jsx("p",{className:"text-gray-500",children:"Aucun membre avec photo trouvé"})]})},x=({member:s})=>{const[a,i]=r.useState(null),[n,l]=r.useState(null),[c,o]=r.useState(!1);return r.useEffect(()=>{console.log(`[Test] Chargement image pour ${s.first_name} ${s.last_name}`,s.photo_url),d(s.photo_url).then(t=>{console.log("[Test] URL reçue:",t),i(t)}).catch(t=>{console.error("[Test] Erreur:",t),l(t.message)})},[s.id]),e.jsxs("div",{className:"border p-4 rounded-lg",children:[e.jsxs("h2",{className:"font-bold mb-2",children:[s.first_name," ",s.last_name]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"photo_url en BDD:"})," ",s.photo_url]}),e.jsxs("p",{className:"text-sm",children:[e.jsx("strong",{children:"URL signée générée:"}),e.jsx("br",{}),e.jsx("span",{className:"text-xs break-all",children:a||"En attente..."})]}),n&&e.jsxs("p",{className:"text-red-500 text-sm",children:[e.jsx("strong",{children:"Erreur:"})," ",n]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm font-semibold mb-2",children:"Test d'affichage :"}),a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Image simple (img tag):"}),e.jsx("img",{src:a,alt:`${s.first_name} ${s.last_name}`,className:"w-32 h-32 object-cover rounded-full border-2",onLoad:()=>{console.log(`[Test] Image chargée avec succès pour ${s.first_name}`),o(!0)},onError:t=>{console.error(`[Test] Erreur chargement image pour ${s.first_name}`,t),l("Erreur de chargement de l'image")}}),c&&e.jsx("p",{className:"text-green-500 text-xs mt-1",children:"✓ Image chargée avec succès"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Lien direct:"}),e.jsx("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 text-xs underline",children:"Ouvrir l'image dans un nouvel onglet"})]})]})]})]})]})};export{u as default};
