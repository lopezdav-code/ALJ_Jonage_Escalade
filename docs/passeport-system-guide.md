# Syst√®me de Validation des Passeports d'Escalade

Ce syst√®me permet de valider et suivre les passeports d'escalade des membres du club selon le r√©f√©rentiel de la FFME.

## Types de Passeports

### üü¢ Passeport Blanc
**Objectif :** Grimper en moulinette de fa√ßon autonome sur SAE

**Comp√©tences valid√©es (15) :**
1. S'√©quiper pour grimper
   - Choisir des chaussons adapt√©s
   - Enfiler son baudrier correctement
   - Faire un n≈ìud de huit

2. Assurer en s√©curit√©
   - Contr√¥ler son partenaire de cord√©e
   - Assurer en moulinette
   - Descendre le grimpeur en s√©curit√©

3. Grimper en t√™te sur SAE
   - Grimper des voies vari√©es
   - Utiliser diff√©rentes techniques
   - G√©rer son effort

4. Lire une voie d'escalade
   - Observer et analyser
   - Identifier les prises et mouvements
   - Anticiper les difficult√©s

5. √ätre autonome sur SAE
   - Pr√©parer et ranger la corde
   - Ranger le mat√©riel
   - Respecter les r√®gles de s√©curit√©

### üü° Passeport Jaune
**Objectif :** Grimper en t√™te sur structure artificielle d'escalade

**Comp√©tences valid√©es (24) :**
1. S'√©quiper et pr√©parer sa grimpe en t√™te
   - Choisir des chaussons adapt√©s
   - Enfiler et r√©gler son baudrier
   - Faire un n≈ìud de huit avec v√©rification
   - Contr√¥ler son partenaire
   - Pr√©parer et positionner ses d√©gaines

2. Grimper en t√™te sur SAE
   - Clipper la corde dans une d√©gaine
   - Grimper avec fluidit√©
   - G√©rer la corde pendant l'ascension
   - Anticiper les points de repos et clippages
   - G√©rer son stress et sa peur de chute

3. Assurer un grimpeur en t√™te
   - Assurer de mani√®re dynamique
   - Donner et reprendre du mou
   - Parer une chute en d√©but de voie
   - Ravaler la corde efficacement
   - Faire descendre le grimpeur en s√©curit√©

4. Lire et analyser une voie
   - Identifier les sections difficiles
   - Planifier les s√©quences de mouvements
   - √âvaluer les risques de chute
   - Adapter sa strat√©gie pendant la grimpe

5. Conna√Ætre les r√®gles de s√©curit√©
   - Conna√Ætre les n≈ìuds de s√©curit√©
   - V√©rifier l'√©tat du mat√©riel
   - Communiquer clairement avec son partenaire
   - Respecter les autres grimpeurs
   - Savoir r√©agir en cas d'incident

### üü† Passeport Orange
**Objectif :** Grimper en t√™te en falaise √©cole

**Comp√©tences valid√©es (30) :**
1. Pr√©parer une sortie en falaise √©cole
   - Choisir un site adapt√© √† son niveau
   - V√©rifier les conditions m√©t√©orologiques
   - Pr√©parer le mat√©riel n√©cessaire
   - √âvaluer le niveau de difficult√© des voies
   - Planifier l'horaire et l'organisation

2. S'√©quiper pour grimper en falaise
   - Choisir l'√©quipement adapt√©
   - Contr√¥ler l'√©tat du mat√©riel
   - Enfiler correctement baudrier et casque
   - Faire son encordement
   - Pr√©parer ses d√©gaines et mat√©riel de relais

3. Grimper en t√™te en falaise √©cole
   - Grimper en t√™te sur voie √©quip√©e
   - Clipper correctement dans les d√©gaines
   - G√©rer sa corde (√©viter frottements, tirage)
   - √âvaluer et choisir son itin√©raire
   - G√©rer son effort et ses points de repos

4. Assurer un grimpeur en falaise
   - Assurer un grimpeur en t√™te
   - G√©rer le mou de corde
   - Parer une √©ventuelle chute
   - Installer un relais en t√™te de voie
   - Conna√Ætre les techniques de mouflage et secours de base

5. Installer et v√©rifier un relais
   - Choisir un bon emplacement de relais
   - Installer des anneaux de sangle ou utiliser les points en place
   - R√©aliser une triangulation correcte
   - V√©rifier la solidit√© du relais
   - Communiquer clairement lors de l'installation

6. Conna√Ætre la r√©glementation et l'environnement
   - Respecter la r√©glementation locale
   - Conna√Ætre les voies d'acc√®s et parkings
   - Pr√©server l'environnement naturel
   - G√©rer ses d√©chets
   - Respecter les autres usagers du site

### üî¥ Passeport Rouge *(√† venir)*
**Objectif :** Grimper en autonomie sur tous terrains

## Utilisation du Syst√®me

### Pour les Administrateurs

#### 1. Acc√©der √† la page de validation
- Connectez-vous en tant qu'administrateur
- Cliquez sur **"Passeports"** dans le menu de navigation
- Vous acc√©dez √† `/passeport-validation`

#### 2. S√©lectionner un membre
- Utilisez le menu d√©roulant pour choisir un membre √† √©valuer
- Les membres sont tri√©s par nom de famille
- Le passeport actuel du membre est affich√© s'il en poss√®de un

#### 3. Choisir le type de passeport
- S√©lectionnez le type de passeport √† valider :
  - **Blanc** : Moulinette autonome (15 comp√©tences)
  - **Jaune** : Grimpe en t√™te SAE (24 comp√©tences)
  - **Orange** : Grimpe en t√™te falaise √©cole (30 comp√©tences)
  - Rouge (√† venir)

#### 4. Remplir le formulaire de validation
- **Informations du grimpeur** : Pr√©-remplies depuis la fiche membre
- **Comp√©tences** : Cochez chaque comp√©tence valid√©e
  - La barre de progression s'actualise en temps r√©el
  - Toutes les comp√©tences doivent √™tre valid√©es
- **Date de validation** : Date officielle de l'obtention du passeport
- **Validateur** : Nom de l'initiateur/moniteur
- **Observations** : Commentaires sur la performance, axes de progr√®s (optionnel)

#### 5. Valider le passeport
- Le bouton de validation est actif uniquement si toutes les comp√©tences sont coch√©es
- Une fois valid√© :
  - L'entr√©e est enregistr√©e dans la table `passeport_validations`
  - Le champ `passeport` du membre est mis √† jour
  - Un toast de confirmation s'affiche

### Pour les Membres

#### Visualiser son historique de passeports
L'historique des passeports peut √™tre affich√© dans la fiche d√©taill√©e du membre avec le composant `PasseportHistory` :

```jsx
import PasseportHistory from '@/components/PasseportHistory';

<PasseportHistory memberId={member.id} />
```

## Base de Donn√©es

### Table `passeport_validations`

```sql
CREATE TABLE passeport_validations (
  id UUID PRIMARY KEY,
  member_id UUID REFERENCES members(id),
  passeport_type TEXT CHECK (passeport_type IN ('blanc', 'jaune', 'orange', 'rouge')),
  competences JSONB,
  date_validation DATE,
  validateur TEXT,
  observations TEXT,
  validated_at TIMESTAMP,
  created_at TIMESTAMP,
  updated_at TIMESTAMP
);
```

#### Colonnes :
- **id** : Identifiant unique de la validation
- **member_id** : R√©f√©rence au membre ayant obtenu le passeport
- **passeport_type** : Type de passeport (blanc, jaune, orange, rouge)
- **competences** : Objet JSON contenant toutes les comp√©tences valid√©es
- **date_validation** : Date officielle de validation
- **validateur** : Nom de l'initiateur/moniteur
- **observations** : Remarques sur la performance
- **validated_at** : Timestamp de l'enregistrement
- **created_at** : Date de cr√©ation de l'enregistrement
- **updated_at** : Date de derni√®re modification

### Installation de la table

Ex√©cutez le script SQL :
```bash
psql -U postgres -d votre_base < scripts/create-passeport-validations-table.sql
```

Ou directement dans Supabase SQL Editor :
1. Allez dans **SQL Editor**
2. Collez le contenu de `scripts/create-passeport-validations-table.sql`
3. Cliquez sur **Run**

## Structure des Fichiers

```
src/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ PasseportBlancForm.jsx      # Formulaire de validation Blanc (15 comp√©tences)
‚îÇ   ‚îú‚îÄ‚îÄ PasseportJauneForm.jsx      # Formulaire de validation Jaune (24 comp√©tences)
‚îÇ   ‚îú‚îÄ‚îÄ PasseportOrangeForm.jsx     # Formulaire de validation Orange (30 comp√©tences)
‚îÇ   ‚îî‚îÄ‚îÄ PasseportHistory.jsx        # Historique des passeports d'un membre
‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îî‚îÄ‚îÄ PasseportValidation.jsx     # Page principale de validation
‚îî‚îÄ‚îÄ scripts/
    ‚îî‚îÄ‚îÄ create-passeport-validations-table.sql  # Script de cr√©ation de table
```

## Fonctionnalit√©s

‚úÖ **Validation interactive** : Interface utilisateur intuitive avec progression en temps r√©el
‚úÖ **Historique complet** : Conservation de toutes les validations avec d√©tails
‚úÖ **Tra√ßabilit√©** : Enregistrement du validateur et de la date
‚úÖ **Observations** : Possibilit√© d'ajouter des commentaires p√©dagogiques
‚úÖ **Mise √† jour automatique** : Le passeport du membre est automatiquement mis √† jour
‚úÖ **Design responsive** : Adapt√© √† tous les √©crans
‚úÖ **Validation stricte** : Impossible de valider sans toutes les comp√©tences

## Am√©liorations Futures

- [ ] Passeport Rouge (autonomie compl√®te)
- [ ] Export PDF des passeports valid√©s
- [ ] Statistiques de validation par p√©riode
- [ ] Notifications par email lors de la validation
- [ ] Syst√®me de renouvellement/recyclage
- [ ] Interface de r√©vision des comp√©tences
- [ ] Galerie de photos de r√©alisations
- [ ] Carnet de voies grimp√©es en falaise

## Support

Pour toute question ou probl√®me, contactez l'√©quipe de d√©veloppement du club.
